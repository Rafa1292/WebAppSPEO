@model IEnumerable<WebApplication1.ViewModel.ArticleViewModel>

@{
    ViewBag.Title = "PropertiesView";
}

<div class="p-4">

    <div class=" d-flex justify-content-center ">
        <img class="rounded" src="~/Images/logo2.png" style="height:100px;" />
    </div>
    <div class="justify-content-center text-center p-4 d-flex">
        <h5>
            Tenemos mas de 500 propiedades a tu disposicion.
            <br />
            Vamos a verlas!!!
        </h5>
    </div>

    <div class="container-fluid flex-wrap d-flex">
        <div class="col-md-2 flex-wrap d-flex p-2 py-4" style="background-color: rgba(0, 0, 0, .4); height: max-content;">
            <div class="col-12 text-light d-flex justify-content-center mb-2">
                <label class="px-5 py-2 border border-light rounded font-weight-bold">
                    Filtro
                </label>
            </div>
            <div class="col-12 text-light d-flex ">
                <label class="p-2">
                    Filtrar por:
                </label>
            </div>
            <div class="col-12 mb-2">
                <select class="form-control" id="type" onchange="getParamsList(this.value)">
                    <option selected disabled value="0">Seleccionar tipo</option>
                    <option value="Ubicacion">Ubicacion</option>
                    <option value="Categoria">Categoria</option>
                    <option value="Tamaño">Tamaño</option>
                    <option value="Precio">Precio</option>
                </select>
            </div>
            <div class="col-12 mb-2 " style="display: none;" id="currency">
                <label class="p-2 col-12 text-light">
                    Moneda
                </label>
                <select class="form-control" onchange="GetPrices(this.value)">
                    <option selected disabled value="0">Seleccionar moneda</option>
                    <option value="¢">¢ - Colones</option>
                    <option value="$">$ - Dolares</option>

                </select>
            </div>
            <div class="col-12 text-light d-flex ">
                <label class="p-2">
                    Opciones:
                </label>
            </div>
            <div class="col-12 mb-2">
                <select class="form-control" id="option" onchange="Filter(false)">
                    <option selected disabled value="0">Seleccionar Filtro</option>
                </select>
            </div>

            <div class="col-12 mb-2 d-flex justify-content-center my-3 p-2 ">
                <button class="btn btn-danger" type="button" onclick="Filter(true)">
                    Reiniciar filtro
                </button>
            </div>
        </div>

        <div class="d-flex flex-wrap col-10" id="articleListContainer">
            @Html.Partial("ArticleList")
        </div>
    </div>

</div>

<div class="modal p-0" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="background-color: rgba( 255, 255, 255, .5)">
    <div class="modal-dialog load-gif m-0" role="document">
        <div class="modal-content load-gif bg-transparent">
            <img class="house-gif" src="~/Images/home-solid.svg" height="100" id="house-gif" />

        </div>
    </div>
</div>

<script>

    function getParams(paramsList) {
            document.getElementById("option").innerHTML = paramsList;
    }

    function GetSizes() {

        var content =
            `<option selected disabled value="0">Seleccionar tamaño</option>
              <option value="1">100mts - 300mts</option>
             <option value="2">300mts - 500mts</option>
             <option value="3">500mts - 700mts</option>
             <option value="4">700mts - En adelante</option>`

        document.getElementById("option").innerHTML = content;

    }

    function GetPrices(currency) {
                $('#exampleModal').modal('show');

        var content = "";
        if (currency == "$") {
             content =
            `<option selected disabled value="0">Seleccionar moneda</option>
             <option value="1">$20,000 - $30,000</option>
             <option value="2">$30,000 - $40,000</option>
             <option value="3">$40,000 - En adelante</option>`
        }
        else {
            content =
            `<option selected disabled value="0">Seleccionar monto</option>
             <option value="4">¢10,000,000 - ¢20,000,000</option>
             <option value="5">¢20,000,000 - ¢30,000,000</option>
             <option value="6">¢30,000,000 - En adelante</option>`
        }

        document.getElementById("option").innerHTML = content;
                $('#exampleModal').modal('hide');

    }

    function getParamsList(type) {
            $('#exampleModal').modal('show');

        document.getElementById("currency").style.display = "none";

        switch (type) {

            case "Precio":
                document.getElementById("currency").style.display = "block";
                break;
            case "Tamaño":
                GetSizes();
                break;

            default:
                 $.ajax({
                    type: "POST",
                    url: '@Url.Action("GetParamsList","Home")',
                    data: {
                        type: type
                    },
                    cache: false
                })
                    .then(function (data) {
                        getParams(data);
                    })
                    .fail(function (data) {
                        alert('No hay caracteristicas que mostrar!');
                    })

                return false;
        }
        
                $('#exampleModal').modal('hide');

    }

    function Filter(clean) {
        $('#exampleModal').modal('show');

        if (clean) {
            getArticles("", "");
            document.getElementById("option").innerHTML = `<option selected disabled value="0">Seleccionar filtro</option>`;
            var type = document.getElementById("type").value = 0;
            document.getElementById("currency").style.display = "none";
        }
        else {
            var type = document.getElementById("type").value;
            var param = document.getElementById("option").value;
            getArticles(type, param);
        }
        $('#exampleModal').modal('hide');

    }

        function getArticles(type, param) {

            $.ajax({
                type: "POST",
                url: '@Url.Action("GetArticles","Home")',
                data: {
                    type: type,
                    param: param
                },
                cache: false
            })
                .then(function (data) {
                    var element = document.getElementById("articleListContainer");
                    element.innerHTML = data;
                })
                .fail(function (data) {
                    alert('No hay caracteristicas que mostrar!');
                })
               return false;
        }


</script>